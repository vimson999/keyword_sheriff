插件介绍
「插件」是多维表格推出的一个灵活、便捷的开放能力，你可以开发自定义插件，或使用共享插件，从而快速地完成重复任务、构建更强大的业务系统。详细介绍可见使用多维表格插件。
常见使用场景
- 根据自定义逻辑批量的处理记录（如删除重复记录等）
- 根据自定义逻辑批量的处理列数据（如查找替换、URL 转附件等）
- 基于多维表格数据开发一个自定义功能（如抽奖、导出内嵌图片的 Excel 等）
- 基于数据读写能力，将您的数据写入到多维表格后进行处理，或将数据处理后上传到您的业务系统。
如需开发「连接器插件」，可查看多维表格「连接器插件」开发者指南 ，连接器插件可以实现从外部数据同步到多维表格的功能。
交流群
如有插件相关的反馈和需求，请加入以下社群讨论；如果你还不会写代码，可以入群提插件需求。
暂时无法在飞书文档外展示此内容

准备工作
- 注册 Replit 账号 https://replit.com（可选，或者直接clone github 上模板（见下文中的“模板”）即可）。Replit 是一个在线、协同编程环境，你可以直接在浏览器中编写和运行代码，它支持多种语言，包括且不限于 JavaScript、Node.js、Python、Golang 等。
只需一个有效的 URL 地址，你就能轻松使用我们的插件了。虽然这里我们以 Replit 平台为例，但无论是 Vercel、Github、localhost，还是你自己的服务器，只要部署了服务，我们的插件都能支持运行。
前端插件与服务端插件的区别

读写多维表格数据
渲染页面与用户交互
关闭插件或多维表格后仍可运行
前端插件
✅
✅
❌
服务端插件
✅
❌
✅
前后端结合插件
✅
✅
✅
前端插件
模板
多维表格提供了一系列的模板帮助你快速开发：
纯前端模板
仅使用前端 JS 
如果你准备开发表单UI，或者你是非前端开发同学，想降低 UI 搭建成本，建议使用以下模板：
1.  UIBuilder 模板，github地址 入口为src/runUIBuilder.tsx文件，具体使用方法见UIBuilder 模板使用指南 
如果你有前端开发经验则可以使用以下模板来自由搭建 UI：
1. HTML 模板，github地址 入口为 src/index.ts 文件
2. React 模板，github地址 入口为 src/App.tsx 文件
3. Vue 模板，github地址 入口为src/App.vue文件
前后端组合模板
nextjs无法静态部署，如需官方部署，请优先使用其他的模板。
1. Nextjs 模板，前端入口为 pages/index.tsx 文件，服务端入口为pages/api目录下的文件
请根据你的业务场景和技术栈，选择对应的模板然后点击右上角的 Fork 按钮将模板 Fork 到你的 Replit 账号内进行开发
开发你的第一个前端插件
跟随指南我们将会初始化一个新增一行记录的前端插件，其功能如视频所示：
暂时无法在飞书文档外展示此内容
操作步骤：
1. 选择一个纯前端模板（此处以UIBuilder模板为例），点击「Fork」按钮将其 Fork 到你的帐号内（需要注册登录replit，使用任意邮箱即可）
2. 点击 IDE 页面中上方的「Run」按钮启动项目，然后点击 Webview 右侧的"New Tab"，并复制 URL
3. 新建或打开任意多维表格，然后点击左下角侧边栏的「更多」按钮
4. 点击「自定义插件」，点击「+新增插件」，在输入框内填入预览地址后点击「确定」按钮添加并运行插件
你可在 IDE 中修改代码，多维表格中的插件会动态刷新，如果你需要查看页面的调试信息，可在多维表格按 F12 打开控制台，或者右键检查元素也可。
下一步
借助多维表格插件API提供 API，可以实现更丰富功能的插件如：
简易的查找替换插件
我们会将当前表格中名为「多行文本」字段的 hi 替换成 hello，具体代码可查看 Find And Replace Sample，该插件的功能如视频所示：
暂时无法在飞书文档外展示此内容
其核心代码如下：
import './App.css';
import { bitable, IOpenSegmentType } from "@base-open/web-api";
import { Button } from '@douyinfe/semi-ui';

// Text you want to find
const findText = 'hi';
// Text you want to replace
const replaceText = 'hello';

export default function App() {
  const replace = async () => {
    //获取当前所选的信息。 Get the current selection
    const selection = await bitable.base.getSelection();
    //通过tableId获取table数据表。 Find current table by tableId
    const table = await bitable.base.getTableById(selection?.tableId!);
    //获取table数据表的字段列表元信息。Get table's field meta list
    const fieldMetaList = await table.getFieldMetaList();
    //找到名为"Multiline" 或 "多行文本" 的字段元信息。 Find the field with the same name as Multiline or 多行文本
    const textField = fieldMetaList.find(({ name }) => name === 'Multiline' || name === '多行文本');
    //获取table的所有记录的ID。 Get all records
    const recordIdList = await table.getRecordIdList();
    for (let i = 0; i < recordIdList.length; i++) {
      //获取单元格字符串形式的值。 Get cell string from specified fieldId and recordId
      const cellString = await table.getCellString(textField?.id!, recordIdList[i]!);
      if (cellString?.includes(findText)) {
        const newText = cellString.replaceAll(findText, replaceText);
        //更新单元格的值 Update the value of the specified fieldId and recordId
        await table.setCellValue(textField?.id!, recordIdList[i]!, [{
          type: IOpenSegmentType.Text,
          text: newText,
        }]);
      }
    }
  };

  return (
    <main>
      <Button theme='solid' type='primary' onClick={replace}>Replace hi to hello</Button>
    </main>
  );
}
前端 API 文档
恭喜你完成了第一个前端插件的开发，请阅读以下文章以了解更多关键概念
- 查看插件 API 以了解更多前端插件的 API
服务端插件
模板
多维表格提供了一系列的模板帮助你快速开发：
后端模板
1. Nodejs 模板，入口为server.ts文件
2. Python 模板，入口文件为main.py文件
前后端组合模板
1. Nextjs 模板，github地址 前端入口为 pages/index.tsx 文件，服务端入口为pages/api目录下的文件
请根据你的业务场景和技术栈，选择对应的模板然后点击右上角的 Fork 按钮将模板 Fork 到你的 Replit 账号内进行开发
开发你的第一个服务端插件
跟随指南，我们将会初始化一个查找并替换文档文本的服务端插件，其的功能如视频所示：
暂时无法在飞书文档外展示此内容
操作步骤：
1. 选择一个后端模板（以Nodejs 模板为例），点击「Fork」按钮将其 Fork 到你的帐号内（需要注册登录replit，使用任意邮箱即可）
2. 点击 IDE 页面中上方的「Run」按钮启动项目，然后拷贝 IDE 右侧的预览地址
3. 新建或打开任意多维表格，然后点击侧边栏的「更多」，并点击「自定义插件」，「+新增插件」
4. 参考获取授权码 PERSONAL_BASE_TOKEN 然后在 Replit 中填入
5. 参考获取 APP_TOKEN 然后在 Replit 中填入
6. 参考获取 TABLE_ID 然后在 Replit 中填入
7. 点击「+新增插件」，在输入框内填入预览地址后点击「确定」按钮运行插件
下一步
你也可以在自动化的发送 HTTP  请求中使用服务端插件，实现根据不同触发条件（添加新纪录时、记录内容变更时等）触发你的插件
暂时无法在飞书文档外展示此内容
更多
恭喜你完成了第一个服务端插件的开发，请阅读以下文章以了解更多关键概念：
- BaseOpenSDK（Node.js）官方文档 
- BaseOpenSDK（Python）官方文档 
- BaseOpenSDK（Golang）官方文档 
托管服务的方式

Replit /  默认托管
Replit 部署
多维表格托管
说明
1. 服务一段时间不活跃后会自动休眠，详情见About Deployments
2. 不区分开发和生产环境，修改会直接影响线上服务
3. Replit 提供的免费服务
1. 服务不会自动休眠，详情见 About Deployments
2. 区分开发和生产环境，修改不会直接影响线上服务
3. 需要绑定信用卡，按月支付部署费用
1. 服务不会自动休眠
2. 开发和部署环境分离，修改不会直接影响线上服务
3. 由多维表格团队负担部署费用
4. 作为多维表格的优秀案例被更多用户看见和使用
适用场景
1. 自用服务、开发&测试功能

1. 对外提供的服务

1. 对外提供的服务
2. 希望你的功能被更多人看见和使用
插件上架到多维表格的步骤
1. 本地打包
我们将直接部署产物，以避免二次构建打包，首先需要指定构建产物目录，比如指定部署dist目录，
在 package.json 中设置 output 属性值为"dist"即可，注意需要同时去掉.gitignore文件中的dist，并在每次代码更新之后重新打包构建一下，然后将重新构建(npm run build)的dist上传即可。
{
  "output": "dist" // 指定直接上传 dist 目录了
}
同时需要注意的是，打包产物的资源引用路径不可以使用绝对路径，请使用相对路径，如在vite.config.js中指定 base:'./'：
import { defineConfig } from "vite";

export default defineConfig({
    base: "./", // 使用相对路径
    //....
});

2. 禁止使用history路由，请使用hash路由
3. 填写共享表单
4. 多维表格审核通过后会 Fork 和部署你的项目
常见问题
如何获取当前Base的授权码（personalBaseToken）
https://bytedance.larkoffice.com/sync/SdiGdL8ETsVRKjbDBDQcY1g8nrb
有关personalBaseToken的详细介绍请阅读 PersonalBaseToken 使用指南  
如何获取 appToken
打开一篇多维表格，其 URL 中 appToken 是下图框住部分。（推荐使用「开发工具」插件获取信息）
[图片]
如何获取 table_id
打开一篇多维表格，其 URL 中 table_id 是下图中框住部分（推荐使用「开发工具」插件获取信息）
[图片]
如何获取 view_id
打开一篇多维表格，其 URL 中 view_id 是下图中框住部分（推荐使用「开发工具」插件获取信息）
[图片]
如何在 Replit 中填入 token
Replit 的项目默认是公开的，即任何人可以发现和查看你的源码，所以强烈建议将 appToken、personalBaseToken、密钥的敏感信息储存在 Secrets 中。
1. 在模板中左下方的 Tools 点击添加「Secrets」面板
2. 在右侧的「Secrets」面板内点击「+ New Secret」然后填入相应的Key和Value
暂时无法在飞书文档外展示此内容
运行插件后显示「发送的响应无效」
请确定您的电脑或您公司的网络没有屏蔽以下域名
*.plz.click
*.shicaizhaopin.net
插件权限
为了确保客户数据安全，插件权限是受限制的
1. 前端插件，接口的权限会跟随执行插件的人；（简而言之：如果该用户在多维表格界面上无权看某些数据，那么插件中也看不到）
2. 服务端插件，插件运行依赖文档所有者提供 PersonalBaseToken ，这个权限等于「文档所有人」的身份，但是必须由他/她亲自获取后提供
如何本地调试开发
你可以将 fork 出来的模板的 node_modules 删掉（如果不删掉就直接下载，可能会有点慢），然后将代码下载到本地。
为了在本地运行代码，你需要安装 nodejs 以及 vscode。
[图片]

然后使用 vscode 打开下载的文件夹，然后新建终端，输入 npm i 并按回车；
安装完毕依赖包之后执行 npm run dev，将本地起的 localhost 项目链接粘贴到插件的预览地址输入框中，然后点击确定就可以看到本地预览的效果了。
[图片]
[图片]
[图片]
如何解决 Edge 红色报错
[图片]
因为插件托管在 Replit 上，可能会被安全检测误报。
- 临时解决方式：在 Edge 中暂时关闭 SmartScreen 功能。设置路径：设置 -> 隐私、搜索和服务 -> Microsoft Defender SmartScreen。
- 更好的解决方案：使用自定义域名，而非使用 replit 公用的域名。详见：Hosting Static Web Pages | Replit Docs。
无法使用共享的插件
- 如碰到这样的报错界面，说明当前网络环境下无法访问插件页面。
[图片]
一般是公司网络下有封禁策略，请添加以下网址为白名单：
- *.replit.app
- *.repl.co
- *.plz.click
- *.shicaizhaopin.net
- *.connectai.site
插件的部署和安全
多维表格插件由多维表格官方和第三方开发者提供，其中代码均由多维表格官方审核，部署在多维表格官方服务器以及认证 ISV 的服务器上，以保证插件的安全合规。
如何将插件分享给其他用户
1. 在任意多维表格内访问插件详情，点击「复制链接」获取可分享的插件 URL 地址
[图片]
2. 你可以将该地址分享给其他用户
暂时无法在飞书文档外展示此内容
如何关闭「插件」功能
- 暂不支持在飞书管理后台关闭该功能。
- 如果还是希望关闭插件功能，请填写申请表单。